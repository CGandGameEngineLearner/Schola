# Schola
The Schola project is an effort to build a toolkit/plugin for controlling Objects in Unreal with Reinforcement Learning. It provides tools to help the user create Environments, define Agents, connect to python based RL Frameworks (e.g. Gym, RLLib or Stable Baselines 3), and power NPCs with RL during games.

## Getting Started

### Install Unreal Engine

This project is designed for Unreal Engine 5.4+ which is available for [Download](https://www.unrealengine.com/en-US/download). It is tested on 5.4.3 and 5.4.4.

> **Important for Visual Studio Users**
> Only MSVC v143 Build Tools should be selected during install including other build tools will cause linking errors. Sepcifically, use `MSVC14.X` where `X>34` from Visual Studio 2022, and `Windows 10.0.22621.0 SDK` to avoid linking errors

### Installing Schola Into Your Project
To use schola in an existing Unreal Engine Project  copy this repository to the `/Plugins` folder of your project, and pip install the schola python package in `/Resources/python`

### Dependencies

#### Python

See `setup.py` for python dependencies. Installing schola via pip will automatically install all python dependencies.

#### C++

All C++ dependencies for using Schola are bundled with the plugin under `/Source/ThirdParty`.

## Build and Test

### Building Third Party Dependencies

Third party dependencies, specifically gRPC and Protobuf can be built using `Schola\Plugins\Schola\Resources\Build\windows_dependencies.bat` or `Schola\Plugins\Schola\Resources\Build\linux_dependencies.sh` depending on your OS. This will update the plugin ThirdParty folder to include copies of the dependencies including .lib/.a files, and copy protoc, and relevant plugins to the tools directory.

### Generating gRPC/Protobuf Code

To generate code for gRPC and Protobuf run `/proto/compile.py`. This will generate `*.pb.cc`, `*.pb.h` and `*.pb.py` files to the correct folders as well as fix several bugs in the default generator (e.g. ignore warnings in C++ code, and fix relative imports for python)

### Generating Documentation

Documentation for Schola is build using a combination of Doxygen + Sphinx + Breathe.

1. Install Doxygen from [the website](https://www.doxygen.nl/) 
2. Install sphinx, breathe, and the Read The Docs theme for sphinx using pip `pip install sphinx breathe sphinx_rtd_theme sphinx-tabs sphinx-copybutton`
3. Generate xml to `/Docs/Doxygen/xml` using the Doxyfile in `/Docs/Doxygen`
4. From the `Docs/Sphinx` folder run `breathe-apidoc -o API/Unreal ../Doxygen/xml`
5. Run sphinx-build or make to generate the unified docs.

## Contributing

### Unreal Coding Style

All unreal code with be styled following the Unreal Style Guide in the [Unreal Documentation](https://docs.unrealengine.com/4.27/en-US/ProductionPipelines/DevelopmentSetup/CodingStandard/).

One potential auto-formatter is the [Clang Formatter](https://github.com/TensorWorks/UE-Clang-Format) which has visual studio support.

#### Comments

Comments are based on doxygen /** style to match closely with javadoc (which Unreal uses) but support handy visual studio features such as comment previews.
To enable autogenerated doxygen stubs go to Tools -> Options -> Text Editor -> C/C++ -> Code Style -> General and change the option from XML to Doxygen (/**).
This will enable autogeneration of stubs with ctrl + /, or whenever you type /\*\* in visual studio.

### Python Coding Style

All python code will be styled( and formatted) following the [Black style guide](https://black.readthedocs.io/en/stable/).
[![Code style: black](https://img.shields.io/badge/code%20style-black-000000.svg)](https://github.com/psf/black) as well as pep.

Black has an automatic formatter as well as Visual Studio support.

#### Comments

Docstrings in python are in [numpydoc](https://numpydoc.readthedocs.io/en/latest/format.html) style and can use any rst directives supported by sphinx. Inherited functions and members can be left undocumented if the implementation doesn't require any additonal details to explain.

### Testing

Testing is implemented through pytests in the ScholaExamples repository. These tests build a fresh copy of this project before running unit tests on Python + Unreal. This tests whether all examples run with each framework and are functional based on the API.
